/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
import React from 'react';
import { NxP, NxCode, NxList } from '@sonatype/react-shared-components';

import { GalleryDescriptionTile, GalleryExampleTile } from '../../gallery-components/GalleryTiles';

const formatVulnerabilityScoreExampleCode = require('./FormatVulnerabilityScoreExample?raw'),
    getVulnerabilitySeverityRatingExampleCode = require('./GetVulnerabilitySeverityRatingExample?raw'),
    vulnerabilityTypesAndRatingsExampleCode = require('./VulnerabilityTypesAndRatingsExample?raw'),
    vulnerabilitySeverityAndScoreRangeListExampleCode = require('./VulnerabilitySeverityAndScoreRangeListExample?raw');

const VulnerabilityRatingUtilsPage = () =>
  <>
    <GalleryDescriptionTile>
      <NxP>
        The React Shared Components library includes several simple JavaScript
        objects and TypeScript types that provide code definitions and mappings to help represent
        CVSS scores and severity ratings.
      </NxP>
      <NxList bulleted>
        <NxList.Item>
          <NxList.Text>
            <strong>Vulnerability (CVSS) Score:</strong>{' '}
            A number with one decimal point precision between 0.0 and 10.0, inclusive,
            that describes the severity of a threat. Zero represents no threat at all,
            and ten represents the most severe of threats.
          </NxList.Text>
        </NxList.Item>
        <NxList.Item>
          <NxList.Text>
            <strong>Vulnerability Severity Rating</strong>{' '}
            In increasing order of severity: <q>none</q>; <q>low</q>; <q>medium</q>; <q>high</q>;
            and <q>critical</q>. Each vulnerability severity rating is a member of a corresponding
            range of CVSS Scores:

            <NxList bulleted>
              <NxList.Item>
                <NxList.Text><strong>none:</strong> 0.0</NxList.Text>
              </NxList.Item>
              <NxList.Item>
                <NxList.Text><strong>low:</strong> 0.1—3.9</NxList.Text>
              </NxList.Item>
              <NxList.Item>
                <NxList.Text><strong>medium:</strong> 4.0—6.9</NxList.Text>
              </NxList.Item>
              <NxList.Item>
                <NxList.Text><strong>high:</strong> 7.0—8.9</NxList.Text>
              </NxList.Item>
              <NxList.Item>
                <NxList.Text><strong>critical:</strong> 9.0—10.0</NxList.Text>
              </NxList.Item>
            </NxList>
          </NxList.Text>
        </NxList.Item>
      </NxList>
    </GalleryDescriptionTile>
    <GalleryExampleTile title="VulnerabilityScore, VulnerabilitySeverityRating, and allVulnerabilitySeverityRatings"
                        codeExamples={vulnerabilityTypesAndRatingsExampleCode}>
      <NxCode>VulnerabilityScore</NxCode> is a TypeScript type consisting of
      only the valid CVSS score strings.
      {' '}<NxCode>VulnerabilitySeverityRating</NxCode> is a TypeScript type consisting of
      only the valid vulnerability severity rating strings.
      {' '}<NxCode>allVulnerabilitySeverityRatings</NxCode> is a read-only array
      containing all possible vulnerability severity rating values.
    </GalleryExampleTile>

    <GalleryExampleTile title="formatVulnerabilityScore" codeExamples={formatVulnerabilityScoreExampleCode}>
      <NxCode>formatVulnerabilityScore</NxCode>{' '}
      is a helper function that formats a number
      into a valid Vulnerability (CVSS) score string representation.
      This ensures the score is valid and displayed consistently.
      This function will throw an error if the number is not within the valid range (0.0 to 10.0),
      or if the number is not within one decimal place.
    </GalleryExampleTile>

    <GalleryExampleTile title="getVulnerabilitySeverityRating" codeExamples={getVulnerabilitySeverityRatingExampleCode}>
      <NxCode>getVulnerabilitySeverityRating</NxCode>{' '}
      is a helper function that categorizes a CVSS score into its corresponding severity rating.
      This ensures that the severity rating is accurately determined based on the CVSS score.
    </GalleryExampleTile>

    <GalleryExampleTile title="vulnerabilitySeverityAndScoreRangeList"
                        codeExamples={vulnerabilitySeverityAndScoreRangeListExampleCode}>
      <NxCode>vulnerabilitySeverityAndScoreRangeList</NxCode> list of objects that describe the ranges of
      of Vulnerability (CVSS) scores and their corresponding severity rating.
    </GalleryExampleTile>
  </>;

export default VulnerabilityRatingUtilsPage;
