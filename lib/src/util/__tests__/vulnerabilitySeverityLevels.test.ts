/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
import { formatCvssScore, getVulnerabilitySeverityLevel, CvssScore } from '../vulnerabilitySeverityLevels';

describe('vulnerabilitySeverityLevels utilities', function() {
  describe('formatCvssScore', function() {
    it('returns the correct CVSS score string given floating point number', function() {
      expect(formatCvssScore(-1)).toBe('0.0');
      expect(formatCvssScore(0)).toBe('0.0');
      expect(formatCvssScore(2)).toBe('2.0');
      expect(formatCvssScore(3.3)).toBe('3.3');
      expect(formatCvssScore(4.55)).toBe('4.5');
      expect(formatCvssScore(5.88)).toBe('5.9');
      expect(formatCvssScore(10)).toBe('10.0');
      expect(formatCvssScore(11)).toBe('10.0');
    });
  });

  describe('getVulnerabilitySeverityLevel', function() {
    it('returns the correct category for each valid cvssScore', function() {
      expect(getVulnerabilitySeverityLevel('0.0')).toBe('none');
      expect(getVulnerabilitySeverityLevel('0.1')).toBe('low');
      expect(getVulnerabilitySeverityLevel('3.9')).toBe('low');
      expect(getVulnerabilitySeverityLevel('4.0')).toBe('medium');
      expect(getVulnerabilitySeverityLevel('6.9')).toBe('medium');
      expect(getVulnerabilitySeverityLevel('7.0')).toBe('high');
      expect(getVulnerabilitySeverityLevel('8.9')).toBe('high');
      expect(getVulnerabilitySeverityLevel('9.0')).toBe('critical');
      expect(getVulnerabilitySeverityLevel('10.0')).toBe('critical');
      expect(getVulnerabilitySeverityLevel('11.0' as CvssScore)).toBe(null);
    });
  });
});
