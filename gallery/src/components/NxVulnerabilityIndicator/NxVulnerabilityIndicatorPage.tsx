/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
import React from 'react';
import { NxTable, NxCode, NxP, NxTextLink, NxH3 } from '@sonatype/react-shared-components';

import { GalleryDescriptionTile, GalleryExampleTile } from '../../gallery-components/GalleryTiles';

import NxVulnerabilityIndicatorBySeverityExample from './NxVulnerabilityIndicatorBySeverityExample';
import NxVulnerabilityIndicatorByScoreExample from './NxVulnerabilityIndicatorByScoreExample';
import NxVulnerabilityIndicatorListExample from './NxVulnerabilityIndicatorListExample';
import NxVulnerabilityIndicatorTableExample from './NxVulnerabilityIndicatorTableExample';
import NxVulnerabilityIndicatorWithTitleExample from './NxVulnerabilityIndicatorWithTitleExample';

const nxVulnerabilityIndicatorBySeverityCode = require('./NxVulnerabilityIndicatorBySeverityExample?raw'),
    nxVulnerabilityIndicatorByScoreCode = require('./NxVulnerabilityIndicatorByScoreExample?raw'),
    nxVulnerabilityIndicatorListCode = require('./NxVulnerabilityIndicatorListExample?raw'),
    nxVulnerabilityIndicatorTableCode = require('./NxVulnerabilityIndicatorTableExample?raw'),
    nxVulnerabilityIndicatorWithTitleCode = require('./NxVulnerabilityIndicatorWithTitleExample?raw');

const NxVulnerabilityIndicatorPage = () =>
  <>
    <GalleryDescriptionTile>
      <NxP>
        <NxCode>NxVulnerabilityIndicator</NxCode> is an inline element used
        to indicate via color the CVSS severity rating of the information that follows it.
      </NxP>
      <NxP>
        There are two scales to choose from: vulnerability rating by category, and vulnerability
        rating by score. When using this component, it is expected that just one of the props will be passed. If both
        are passed, <NxCode>severityRating</NxCode> takes precedence.
      </NxP>
      <NxTable>
        <NxTable.Head>
          <NxTable.Row>
            <NxTable.Cell>Prop</NxTable.Cell>
            <NxTable.Cell>Type</NxTable.Cell>
            <NxTable.Cell>Required</NxTable.Cell>
            <NxTable.Cell>Details</NxTable.Cell>
          </NxTable.Row>
        </NxTable.Head>
        <NxTable.Body>
          <NxTable.Row>
            <NxTable.Cell>severityRating</NxTable.Cell>
            <NxTable.Cell>One of 'none', 'low', 'medium', 'high', or 'critical'</NxTable.Cell>
            <NxTable.Cell>No</NxTable.Cell>
            <NxTable.Cell>A Vulnerability Severity Rating off of which to base the indicator color</NxTable.Cell>
          </NxTable.Row>
          <NxTable.Row>
            <NxTable.Cell>score</NxTable.Cell>
            <NxTable.Cell>0.0â€”10.0 inclusive</NxTable.Cell>
            <NxTable.Cell>No</NxTable.Cell>
            <NxTable.Cell>A Vulnerability (CVSS) Score off of which to base the indicator color</NxTable.Cell>
          </NxTable.Row>
          <NxTable.Row>
            <NxTable.Cell>title</NxTable.Cell>
            <NxTable.Cell>string</NxTable.Cell>
            <NxTable.Cell>No</NxTable.Cell>
            <NxTable.Cell>
              Specifies the tooltip content. By default, it includes the Vulnerability Severity Rating along
              with additional details such as the number of vulnerabilities and their respective CVSS scores.
            </NxTable.Cell>
          </NxTable.Row>
          <NxTable.Row>
            <NxTable.Cell>className</NxTable.Cell>
            <NxTable.Cell>string</NxTable.Cell>
            <NxTable.Cell>No</NxTable.Cell>
            <NxTable.Cell>Additional CSS class names to apply to the rendered element</NxTable.Cell>
          </NxTable.Row>
          <NxTable.Row>
            <NxTable.Cell>presentational</NxTable.Cell>
            <NxTable.Cell>boolean</NxTable.Cell>
            <NxTable.Cell>No</NxTable.Cell>
            <NxTable.Cell>
              When this is true, the tooltip will be hidden, aria-label will not be set,
              and the icon's role will be set to "presentation".
              This should be set to true when <NxCode>NxVulnerabilityIndicator</NxCode> is used alongside
              visible text that repeats its meaning.
              For example, In the case of a Critical <NxCode>NxVulnerabilityIndicator</NxCode> with "Critical"
              printed next to it, we don't want the screenreader to read the
              <NxCode>NxVulnerabilityIndicator</NxCode> tooltip.
            </NxTable.Cell>
          </NxTable.Row>
        </NxTable.Body>
      </NxTable>

      <NxP>
        The following table shows the mapping between vulnerability score and severity rating.
      </NxP>
      <NxTable>
        <NxTable.Head>
          <NxTable.Row>
            <NxTable.Cell>Vulnerability Score</NxTable.Cell>
            <NxTable.Cell>Vulnerability Severity Rating</NxTable.Cell>
          </NxTable.Row>
        </NxTable.Head>
        <NxTable.Body>
          <NxTable.Row>
            <NxTable.Cell>0.0</NxTable.Cell>
            <NxTable.Cell>none</NxTable.Cell>
          </NxTable.Row>
          <NxTable.Row>
            <NxTable.Cell>0.1{'\u2014'}3.9</NxTable.Cell>
            <NxTable.Cell>low</NxTable.Cell>
          </NxTable.Row>
          <NxTable.Row>
            <NxTable.Cell>4.0{'\u2014'}6.9</NxTable.Cell>
            <NxTable.Cell>medium</NxTable.Cell>
          </NxTable.Row>
          <NxTable.Row>
            <NxTable.Cell>7.0{'\u2014'}8.9</NxTable.Cell>
            <NxTable.Cell>high</NxTable.Cell>
          </NxTable.Row>
          <NxTable.Row>
            <NxTable.Cell>9.0{'\u2014'}10.0</NxTable.Cell>
            <NxTable.Cell>critical</NxTable.Cell>
          </NxTable.Row>
        </NxTable.Body>
      </NxTable>

      <NxH3>
        formatVulnerabilityScore Utility
      </NxH3>
      <NxP>
        To help ensuring consistency, we provide a utility{' '}
        <NxTextLink href="#/pages/Vulnerability Rating Utils/formatVulnerabilityScoreExample">
          formatVulnerabilityScore
        </NxTextLink>{' '}
        to format numbers into the correct Vulnerability (CVSS) Score format when displaying next to the indicator.
      </NxP>
    </GalleryDescriptionTile>

    <GalleryExampleTile title="Vulnerability Indicators by Severity"
                        id="nx-vulnerability-indicator-simple-example"
                        liveExample={NxVulnerabilityIndicatorBySeverityExample}
                        codeExamples={nxVulnerabilityIndicatorBySeverityCode}>
      A series of lines of text, each beginning with an <NxCode>NxVulnerabilityIndicator</NxCode> whose
      color is set to a different <NxCode>vulnerabilitySeverityRating</NxCode> value.
      The <NxCode>NxVulnerabilityIndicator</NxCode> has presentational props set to true because
      they are accompanied by text describing their vulnerability severity rating that matches their tooltip.
    </GalleryExampleTile>

    <GalleryExampleTile title="Vulnerability Indicators by Policy Number"
                        id="nx-vulnerability-indicator-score-example"
                        liveExample={NxVulnerabilityIndicatorByScoreExample}
                        codeExamples={nxVulnerabilityIndicatorByScoreCode}>
      A series of lines of text, each beginning with an <NxCode>NxVulnerabilityIndicator</NxCode> whose
      color is set to a different <NxCode>score</NxCode> value.
    </GalleryExampleTile>

    <GalleryExampleTile title="Vulnerability Indicators in nx-list"
                        id="nx-vulnerability-indicator-list-example"
                        liveExample={NxVulnerabilityIndicatorListExample}
                        codeExamples={nxVulnerabilityIndicatorListCode}>
      An <NxCode>.nx-list</NxCode> including rows in various configurations, each starting with
      an <NxCode>NxVulnerabilityIndicator</NxCode>. Note that this list uses such a wide variety of
      items for layout illustration purposes only. In practice you would not, for instance, have action buttons within
      an item of a clickable list.
    </GalleryExampleTile>

    <GalleryExampleTile title="Vulnerability Indicators in nx-table"
                        id="nx-vulnerability-indicator-table-example"
                        liveExample={NxVulnerabilityIndicatorTableExample}
                        codeExamples={nxVulnerabilityIndicatorTableCode}>
      Since <NxCode>nx-table</NxCode> is one of the primary places
      that <NxCode>NxVulnerabilityIndicator</NxCode> is intended to be used, this example demonstrates a
      typical usage of it. Note that no special classes or placements are needed here, it is essentially just the
      usual inline layout of the vulnerability indicator and adjacent content, within a table cell.
    </GalleryExampleTile>

    <GalleryExampleTile title="Vulnerability Indicators with title"
                        id="nx-vulnerability-indicator-with-title-example"
                        liveExample={NxVulnerabilityIndicatorWithTitleExample}
                        codeExamples={nxVulnerabilityIndicatorWithTitleCode}>
      You can modify the tooltip content by setting the <NxCode>title</NxCode> prop.
      By default, the <NxCode>title</NxCode> is set to the Vulnerability Severity Rating.
    </GalleryExampleTile>
  </>;

export default NxVulnerabilityIndicatorPage;
