/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
import { toCvssScoreString, getVulnerabilityLevelCategory, CvssScore } from '../vulnerabilityLevels';

describe('vulnerabilityLevels utilities', function() {
  describe('toCvssScoreString', function() {
    it('returns the correct CVSS score string given floating point number', function() {
      expect(toCvssScoreString(-1)).toBe('0.0');
      expect(toCvssScoreString(0)).toBe('0.0');
      expect(toCvssScoreString(2)).toBe('2.0');
      expect(toCvssScoreString(3.3)).toBe('3.3');
      expect(toCvssScoreString(4.55)).toBe('4.5');
      expect(toCvssScoreString(5.88)).toBe('5.9');
      expect(toCvssScoreString(10)).toBe('10.0');
      expect(toCvssScoreString(11)).toBe('10.0');
    });
  });

  describe('getVulnerabilityLevelCategory', function() {
    it('returns the correct category for each valid cvssScore', function() {
      expect(getVulnerabilityLevelCategory('0.0')).toBe('none');
      expect(getVulnerabilityLevelCategory('0.1')).toBe('low');
      expect(getVulnerabilityLevelCategory('3.9')).toBe('low');
      expect(getVulnerabilityLevelCategory('4.0')).toBe('medium');
      expect(getVulnerabilityLevelCategory('6.9')).toBe('medium');
      expect(getVulnerabilityLevelCategory('7.0')).toBe('high');
      expect(getVulnerabilityLevelCategory('8.9')).toBe('high');
      expect(getVulnerabilityLevelCategory('9.0')).toBe('critical');
      expect(getVulnerabilityLevelCategory('10.0')).toBe('critical');
      expect(getVulnerabilityLevelCategory('11.0' as CvssScore)).toBe(null);
    });
  });
});
