/**
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
@import '../../scss-shared/nx-variables';
@import '../../scss-shared/nx-container-helpers';
@import '../../scss-shared/nx-text-helpers';

.nx-vulnerability-details {
  @include container-vertical();
  $inline-margin: 4px;

  .nx-grid-col {
    @include container-vertical();
    overflow-x: hidden;
  }

  .nx-grid-col--vuln-details {
    padding-left: 48px;
  }

  a {
    @include container-horizontal();
    color: $nx-link-color;
    text-decoration: none;

    &:hover {
      color: $nx-link-color-hover;
    }
  }

  p {
    margin-bottom: $nx-spacing-l;
  }

  dl {
    margin: 0;

    dt {
      display: inline;
    }

    dd {
      display: inline;
      margin-left: $nx-spacing-xs;
    }

    dd + dd {
      margin: 0;
      &::before {
        content: ', ';
      }
    }
  }

  .nx-vulnerability-details__pane {
    @include container-vertical();
    margin: 0 auto;
    max-width: 825px;
  }

  .nx-vulnerability-details__root-cause-path + .nx-vulnerability-details__root-cause-path {
    &::before {
      @include bold();

      content: '<=';
      margin: 0 $inline-margin 0 $inline-margin;
    }
  }

  .nx-vulnerability-details__root-cause-version-range {
    &::before {
      content: ':';
      margin: 0 $inline-margin 0 $inline-margin;
    }
  }

  .nx-vulnerability-details__section {
    @include container-vertical();
    color: $nx-text-color-light;
    margin-bottom: $nx-spacing-xl;

    &:first-child h3 {
      margin-top: 0;
    }
  }

  .nx-vulnerability-details__warning {
    @include container-horizontal;
    color: #cd0028;

    strong {
      @include semi-bold();
    }
  }

  .nx-vulnerability-details__html-detail {
    @include container-vertical();

    margin-bottom: $nx-spacing-md;

    code {
      @extend %nx-code;
    }

    pre {
      background-color: #fff;
      border: 1px solid #474747;
      border-left-width: 8px;
      border-radius: $nx-border-radius;
      color: $nx-text-color-light;
      font-size: $nx-font-size;
      margin: 0 0 $nx-spacing-md 0;
      padding: $nx-spacing-md;
      white-space: pre-wrap;

      code {
        background-color: #fff;
        border: 0;
        color: inherit;
        padding: 0;
        white-space: pre-wrap;
      }
    }

    blockquote {
      @include container-vertical();
      background-color: #f4f5f9;
      border: 1px solid #d1d6f0;
      border-left-width: 8px;
      border-radius: $nx-border-radius;
      margin: 0 0 $nx-spacing-xl 0;
      padding: $nx-spacing-l;
    }
  }
}

.nx-vulnerability-details__section-content {
  @include container-vertical();
}
