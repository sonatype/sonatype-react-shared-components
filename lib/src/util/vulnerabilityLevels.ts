/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */

/**
 * All Possible Policy Vulnerability Level Categories
 */
export const allVulnerabilityLevelCategories = [
  'none',
  'low',
  'medium',
  'high',
  'critical'
] as const;

/**
 * All Possible Policy Vulnerability Levels
 */
export const allVulnerabilityLevelNumbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 1] as const;

/**
 * The type containing only the possible VulnerabilityLevelCategory values
 */
export type VulnerabilityLevelCategory =
  (typeof allVulnerabilityLevelCategories)[number];

/**
 * The type containing only the possible VulnerabilityLevelNumber values
 */
export type VulnerabilityLevelNumber =
  (typeof allVulnerabilityLevelNumbers)[number];

type VulnerabilityLevelCategoryLookup = {
  readonly [idx in VulnerabilityLevelNumber]: VulnerabilityLevelCategory;
};

/**
 * A lookup array used for mapping VulnerabilityLevelNumbers to VulnerabilityLevelCategories.
 * Indexing into this array using a given VulnerabilityLevelNumber will result in the
 * VulnerabilityLevelCategory to which that number belongs.
 */
export const categoryByPolicyVulnerabilityLevel: VulnerabilityLevelCategoryLookup =
  [
    'none',
    'low',
    'medium',
    'medium',
    'high',
    'high',
    'high',
    'high',
    'critical',
    'critical',
    'critical'
  ] as const;

Object.freeze(allVulnerabilityLevelCategories);
Object.freeze(allVulnerabilityLevelNumbers);
Object.freeze(categoryByPolicyVulnerabilityLevel);
