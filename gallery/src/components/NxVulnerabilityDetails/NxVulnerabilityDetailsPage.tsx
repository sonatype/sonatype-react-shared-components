/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
import React from 'react';

import { GalleryDescriptionTile, GalleryExampleTile } from '../../gallery-components/GalleryTiles';
import NxVulnerabilityDetailsExample from './NxVulnerabilityDetailsExample';
import NxVulnerabilityDetailsThirdPartyScanExample from './NxVulnerabilityDetailsThirdPartyScanExample';

const exampleSourceCode = require('!!raw-loader!./NxVulnerabilityDetailsExample').default;
const vulnerabilityDetailsJson = require('../../resources/vulnerabilities/vulnerabilityDetailsJson.json');
const exampleSourceForThirdPartyScans = require('!!raw-loader!./NxVulnerabilityDetailsThirdPartyScanExample').default;
const thirdPartyScanVulnerabilityJson =
  require('../../resources/vulnerabilities/thirdPartyScanVulnerabilityDetails.json');

const NxVulnerabilityDetailsPage = () => {
  const serializedVulnDetailsJson = {
        content: JSON.stringify(vulnerabilityDetailsJson, null, 2),
        language: 'json'
      },
      serializedThirdPartyVulnJson = {
        content: JSON.stringify(thirdPartyScanVulnerabilityJson, null, 2),
        language: 'json'
      };

  return (
    <>
      <GalleryDescriptionTile>
        <p className="nx-p">Renders vulnerability details from vulnerabilityDetails JSON</p>
        <p className="nx-p">Props:</p>
        <table className="nx-table nx-table--gallery-props">
          <thead>
            <tr className="nx-table-row">
              <th className="nx-cell nx-cell--header">Prop</th>
              <th className="nx-cell nx-cell--header">Type</th>
              <th className="nx-cell nx-cell--header">Required</th>
              <th className="nx-cell nx-cell--header">Details</th>
            </tr>
          </thead>
          <tbody>
            <tr className="nx-table-row">
              <td className="nx-cell">vulnerabilityDetails</td>
              <td className="nx-cell">Object</td>
              <td className="nx-cell">Yes</td>
              <td className="nx-cell">
                see <code className="nx-code">VulnerabilityDetails</code> interface
                and <code className="nx-code">vulnerabilityDetailsJson</code> example below
              </td>
            </tr>
          </tbody>
        </table>
        <p className="nx-p">
          VulnerabilityDetails PropType can be imported separately
          as <code className="nx-code">vulnerabilityDetailsPropType</code>.
        </p>
        <p className="nx-p">
          Note that markdown fields in <code className="nx-code">vulnerabilityDetails</code> JSON are expected to use
          {' '}
          <a className="nx-text-link"
             target="_blank"
             rel="noreferrer"
             href="https://spec.commonmark.org/">
            CommonMark
          </a> flavored markdown.
          <br/>Also, in addition to CommonMark spec, a "soft break" is supported: a new line within a paragraph will be
          converted to <code className="nx-code">&lt;br&gt;</code> tag.
        </p>
      </GalleryDescriptionTile>
      <GalleryExampleTile title="General Example"
                          codeExamples={[exampleSourceCode, serializedVulnDetailsJson]}
                          liveExample={NxVulnerabilityDetailsExample}>
        This example shows the display of a typical Sonatype vulnerability with full
        details provided. In addition to the calling code, the JSON data being rendered
        is displayed in a snippet below.
      </GalleryExampleTile>
      <GalleryExampleTile title="Representative example of vulnerability data from third party scans"
                          codeExamples={[exampleSourceForThirdPartyScans, serializedThirdPartyVulnJson]}
                          liveExample={NxVulnerabilityDetailsThirdPartyScanExample}>
        This example shows the display of a typical &quot;third party&quot;
        vulnerability which contains fewer of the optional fields than the general example
        above.
      </GalleryExampleTile>
    </>
  );
};

export default NxVulnerabilityDetailsPage;
